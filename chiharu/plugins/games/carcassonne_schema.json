{
    "$schema": "https://json-schema.org/draft/2020-12/schema",
    "$id": "./carcassonne_schema.json",
    "title": "Carcassonne Data",
    "description": "Carcassonne Data",
    "type": "object",
    "properties": {
        "packs": {
            "type": "array",
            "items": {
                "$ref": "#/$defs/PackData"
            }
        }
    },
    "$defs": {
        "PackData": {
            "description": "Data of a Pack.",
            "type": "object",
            "properties": {
                "name": {
                    "type": "string",
                    "descrption": "The name of this pack."
                },
                "id": {
                    "type": "integer",
                    "descrption": "The ID of this pack."
                },
                "tiles": {
                    "type": "object",
                    "description": "Tiles included by this pack.",
                    "properties": {
                        "a": {
                            "type": "array",
                            "items": {
                                "$ref": "#/$defs/TileData"
                            }
                        },
                        "b": {
                            "type": "array",
                            "items": {
                                "$ref": "#/$defs/TileData"
                            }
                        },
                        "c": {
                            "type": "array",
                            "items": {
                                "$ref": "#/$defs/TileData"
                            }
                        },
                        "d": {
                            "type": "array",
                            "items": {
                                "$ref": "#/$defs/TileData"
                            }
                        },
                        "e": {
                            "type": "array",
                            "items": {
                                "$ref": "#/$defs/TileData"
                            }
                        },
                        "f": {
                            "type": "array",
                            "items": {
                                "$ref": "#/$defs/TileData"
                            }
                        }
                    }
                },
                "tokens": {
                    "type": "array",
                    "description": "Tokens included by this pack.",
                    "items": {
                        "$ref": "#/$defs/TokenData"
                    }
                },
                "starting_tile": {
                    "type": "integer"
                }
            },
            "required": [
                "name",
                "id"
            ]
        },
        "TileData": {
            "description": "Data of a tile.",
            "type": "object",
            "properties": {
                "id": {
                    "type": "integer",
                    "description": "The ID of this tile."
                },
                "sides": {
                    "type": "string",
                    "description": "A 4-char long string standes for the sides of this tile, starting from the top and goes clockwise. C(City), R(Road), F(Field), S(Rivers)."
                },
                "num": {
                    "type": "integer",
                    "description": "How many this tiles goes in this pack."
                },
                "segments": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/SegmentData"
                    }
                },
                "features": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/FeatureData"
                    }
                }
            },
            "required": [
              "id",
              "sides",
              "num",
              "segments"
            ]
        },
        "TokenData": {
            "description": "Data of a token.",
            "type": "object",
            "oneOf": [
              {
                "$ref": "#/$defs/TokenFixedNumData"
              },
              {
                "$ref": "#/$defs/TokenPlayerNumData"
              }
            ],
            "properties": {
                "name": {
                    "type": "string",
                    "description": "The name of this token."
                },
                "distribute": {
                    "type": "boolean",
                    "description": "Whether the token is given for everyone."
                },
                "image": {
                    "type": "array",
                    "description": "The bounding box of the image from assets.",
                    "items": {
                        "type": "integer"
                    },
                    "minItems": 4,
                    "maxItems": 4
                },
                "thing_id": {
                    "type": "string",
                    "description": "The small item id of this follower."
                }
            },
            "required": [
                "name",
                "distribute",
                "image"
            ]
        },
        "TokenFixedNumData": {
            "type": "object",
            "properties": {
                "num": {
                    "type": "integer",
                    "descrption": "The number of this token. If distribute, this number is the number everyone recieves."
                }
            },
            "required": [
                "num"
            ]
        },
        "TokenPlayerNumData": {
            "type": "object",
            "properties": {
                "numOfPlayers": {
                    "type": "object",
                    "descrption": "The number of this token according to player numbers. If distribute, this number is the number everyone recieves.",
                    "properties": {
                        "1": {"type": "integer"},
                        "2": {"type": "integer"},
                        "3": {"type": "integer"},
                        "4": {"type": "integer"},
                        "5": {"type": "integer"},
                        "6": {"type": "integer"}
                    }
                }
            },
            "required": [
                "numOfPlayers"
            ]
        },
        "SegmentData": {
            "oneOf": [
                {
                    "$ref": "#/$defs/CitySegmentData"
                },
                {
                    "$ref": "#/$defs/FieldSegmentData"
                },
                {
                    "$ref": "#/$defs/RoadSegmentData"
                },
                {
                    "$ref": "#/$defs/RiverSegmentData"
                }
            ]
        },
        "BaseSegmentData": {
            "type": "object",
            "properties": {
                "to": {
                    "type": "array",
                    "description": "To which sides does this object connects. For non-fields, 0123 refers to URDL. For fields, 0-7 starts from the right half of the upper side and increases clockwise.",
                    "items": {
                        "type": "integer"
                    }
                },
                "posx": {
                    "type": "integer",
                    "description": "The x position to put token."
                },
                "posy": {
                    "type": "integer",
                    "description": "The y position to put token."
                },
                "features": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/FeatureData"
                    }
                }
            },
            "required": [
              "to"
            ]
        },
        "SegmentPosData": {
            "type": "object",
            "properties": {
                "to": {
                    "type": "array",
                    "description": "To which sides does this object connects. For non-fields, 0123 refers to URDL. For fields, 0-7 starts from the right half of the upper side and increases clockwise.",
                    "items": {
                        "type": "integer"
                    }
                },
                "features": {
                    "type": "array",
                    "items": {
                        "$ref": "#/$defs/FeatureData"
                    }
                }
            },
            "required": [
              "posx",
              "posy"
            ]
        },
        "NonFieldSegmentData": {
            "type": "object",
            "allOf": [
              {
                "$ref": "#/$defs/BaseSegmentData"
              },
              {
                "$ref": "#/$defs/SegmentPosData"
              }
            ],
            "properties": {},
            "required": []
        },
        "CitySegmentData": {
            "description": "The connection between cities.",
            "type": "object",
            "allOf": [
              {
                "$ref": "#/$defs/NonFieldSegmentData"
              }
            ],
            "properties": {
                "type": {
                    "type": "string",
                    "const": "City"
                },
                "pennant": {
                    "type": "integer",
                    "description": "Number of pennant it has. default to zero."
                }
            }
        },
        "FieldSegmentData": {
            "description": "The connection between fields.",
            "type": "object",
            "allOf": [
              {
                "$ref": "#/$defs/BaseSegmentData"
              }
            ],
            "properties": {
                "type": {
                    "type": "string",
                    "const": "Field"
                },
                "adjacent_city": {
                    "type": "array",
                    "description": "Which city this field is adjacent to. Count as index of the list of segments.",
                    "items": "integer"
                }
            },
            "required": [
                "adjacent_city"
            ]
        },
        "RoadSegmentData": {
            "description": "The connection between roads.",
            "type": "object",
            "allOf": [
              {
                "$ref": "#/$defs/NonFieldSegmentData"
              }
            ],
            "properties": {
                "type": {
                    "type": "string",
                    "const": "Road"
                },
                "bush": {
                    "type": "boolean",
                    "description": "Whether the road is covered by bush (not hotel)."
                }
            }
        },
        "RiverSegmentData": {
            "description": "The connection between rivers.",
            "type": "object",
            "allOf": [
              {
                "$ref": "#/$defs/BaseSegmentData"
              }
            ],
            "properties": {
                "type": {
                    "type": "string",
                    "const": "River"
                }
            }
        },
        "FeatureData": {
            "oneOf": [
                {
                    "$ref": "#/$defs/MiscFeatureData"
                },
                {
                    "$ref": "#/$defs/CloisterFeatureData"
                },
                {
                    "$ref": "#/$defs/TradeFeatureData"
                },
                {
                    "$ref": "#/$defs/TowerFeatureData"
                }
            ]
        },
        "MiscFeatureData": {
            "type": "object",
            "properties": {
                "type": {
                    "type": "string",
                    "enum": [
                        "Cathedral",
                        "Inn",
                        "Princess",
                        "Portal",
                        "Dragon",
                        "Volcano",
                        "Pigherd"
                    ]
                }
            },
            "required": [
                "type"
            ]
        },
        "CloisterFeatureData": {
            "type": "object",
            "properties": {
                "type": {
                    "type": "string",
                    "const": "Cloister"
                },
                "posx": {
                    "type": "integer",
                    "description": "The x position to put token."
                },
                "posy": {
                    "type": "integer",
                    "description": "The y position to put token."
                }
            },
            "required": [
                "type",
                "posx",
                "posy"
            ]
        },
        "TradeFeatureData": {
            "type": "object",
            "properties": {
                "type": {
                    "type": "string",
                    "const": "TradeCounter"
                },
                "counter": {
                    "type": "string",
                    "enum": [
                        "Wine",
                        "Grain",
                        "Cloth"
                    ]
                }
            },
            "required": [
                "type",
                "counter"
            ]
        },
        "TowerFeatureData": {
            "type": "object",
            "properties": {
                "type": {
                    "type": "string",
                    "const": "Tower"
                },
                "posx": {
                    "type": "integer",
                    "description": "The x position to put token."
                },
                "posy": {
                    "type": "integer",
                    "description": "The y position to put token."
                }
            },
            "required": [
                "type",
                "posx",
                "posy"
            ]
        }
    }
}